---
title: "Report"
author: "Lucas Steltenpohl"
date: "2023-12-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
nfl.complete <- read.csv("career_combineNoNA.csv")
```

# NFL Quarterback Predictive Analysis

This report is a statistical analysis of the performance and combine statistics of the National Football League (NFL) quarterbacks spanning from the seasons 2009-2016. The data set we utilized was compiled of multiple data sets of performance indicators that are critical in assessing a quarterback's effectiveness and impact on the field. Our data set encompasses a detailed examination of 103 quarterbacks and 22 variables, offering a unique insight into the changing dynamics and skill levels within the league during this period. The 22 variable names and descriptions are found in the table below.  

Variables:             |  Definitions:
---------------------- | ----------------------------
qb                     | Name of Quarterback
att                    | Number of passing attempts made throughout their career
cmp                    | Number of passing completions made throughout their career
yds                    | Number of total passing yards gained throughout their career
ypa                    | Average number of yards gained per attempt made 
td                     | Number of touchdowns thrown 
int                    | Number of interceptions thrown 
sack                   | Number of sacks taken 
loss                   | Number of yards lost when sacked
game_points            | Number of in game points responsible for
experience             | Number of years played in the NFL
Ht                     | Height of player in inches 
Wt                     | Weight of player in lbs
Forty                  | Player's combine 40 meter dash time in seconds 
Vertical               | Player's combine vertical jump in inches 
BroadJump              | Player's combine broad jump (horizontal) in inches
Cone                   | Player's combine 3 cone agility drill in seconds 
Shuttle                | Player's combine lateral speed test in seconds 
Year                   | Year in which the player was drafted 
Av                     | AV (Approximate Value) is a method created by pro-football-reference in an attempt to put a single number on the seasonal value of a player at any position from any year 
Round                  | The NFL draft round the player was selected Note:(1-7 being round, 8 being undrafted free agent)


```{r}
# LDA analysis with combine data to predict if they are an early or late round draft pick

# Maybe modify to test whether they are a early round draft pick or most likely a starter for the team compared to a later pick most likely not a starter

combine.data <- read.csv("career_combineNoNA.csv")

espn.qb <- read.csv("espn.qb.csv")
espn.qb$qb <- espn.qb$player_name
total.combined <- combine.data %>% left_join(espn.qb, by = "qb")
combine.data <- total.combined %>% select(c(1:22, grade))
imp.1 <- mice(combine.data)
combine.data <- complete(imp.1)
# combine.data$grade[which(is.na(combine.data$grade))] <- mean(na.omit(combine.data$grade))

# Setting it to early or late round draft picks, Round 1 and 2 are early, 3 and beyond considered late
combine.data$Round <- ifelse(combine.data$Round==1 | combine.data$Round==2, "Early", "Late")
n <- sample(nrow(combine.data), size=75)
train.df <- combine.data[n,]
test.df <- combine.data[-n,]



lda.2 <- lda(Round~Ht+Wt+Forty+Vertical+BroadJump+Cone+Shuttle+Year+grade, data=combine.data)

pred.2 <- predict(lda.2, test.df)

correct.2 <- pred.2$class == test.df$Round

roc.2 <- roc(test.df$Round, as.numeric(pred.2$class))
roc.2$auc

roc.2$specificities
roc.2$sensitivities

# Predict quarterback rankings with LDA
s.darnold <- data.frame(Ht = 75, Wt = 221, Forty = 4.85, Vertical = 26.5, BroadJump = 105, Cone = 6.96, Shuttle = 4.4, Year = 2018, grade = 94)

predict(lda.2, s.darnold)



```
